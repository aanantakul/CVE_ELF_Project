<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
<style>
      body { padding: 0; font-family: 'Google Sans', sans-serif; background: #f9f9f9; }
      
      /* --- TABS STYLE --- */
      .tab-header {
        display: flex;
        background-color: #fff;
        border-bottom: 1px solid #ddd;
      }
      .tab-btn {
        flex: 1; /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡πÜ ‡∏Å‡∏±‡∏ô */
        
        /* ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ö‡∏ö Flexbox */
        display: flex; 
        justify-content: center; /* ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
        align-items: center;     /* ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
        
        background-color: transparent;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 10px 5px;
        font-size: 13px;
        font-weight: bold;
        color: #666;
        transition: 0.3s;
        border-bottom: 3px solid transparent;
        white-space: nowrap; 
        overflow: hidden;
      }
      .tab-btn:hover { background-color: #f1f1f1; }
      .tab-btn.active {
        color: #1976d2;
        border-bottom: 3px solid #1976d2;
      }
      
      /* --- CONTENT STYLE --- */
      .tab-content {
        display: none;
        padding: 15px;
        animation: fadeEffect 0.5s;
      }
      .block { margin-bottom: 15px; background: #fff; padding: 10px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
      label { display: block; font-weight: bold; margin-bottom: 5px; color: #37474f; font-size: 12px; }
      input[type="text"], select { width: 100%; padding: 6px 8px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; font-size: 13px; }
      .hint { font-size: 10px; color: #888; margin-top: 4px; }
      
      /* BUTTON STYLE */
      button.action { 
        background: #1976d2; 
        color: white; 
        width: 100%; 
        
        /* ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ö‡∏ö Flexbox */
        display: flex;
        justify-content: center; /* ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
        align-items: center;     /* ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
        text-align: center;      /* ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ß‡πâ */

        padding: 10px 5px; 
        border: none; 
        border-radius: 4px; 
        font-size: 13px; 
        font-weight: bold; 
        margin-top: 10px; 
        cursor: pointer; 
        box-shadow: 0 2px 5px rgba(0,0,0,0.2); 
        transition: 0.2s; 
        white-space: nowrap;
      }
      button.action:hover { background: #1565c0; box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
      button.action:disabled { background: #ccc; cursor: not-allowed; }
      
      .error { color: #d32f2f; font-size: 12px; margin-top: 10px; padding: 10px; background: #ffebee; border-radius: 4px; display: none; }

      @keyframes fadeEffect {
        from {opacity: 0;}
        to {opacity: 1;}
      }
    </style>
  </head>
  <body>

    <div class="tab-header">
      <button class="tab-btn active" onclick="openTab(event, 'TabInput')">üìù Input</button>
      <button class="tab-btn" onclick="openTab(event, 'TabSettings')">‚öôÔ∏è Settings</button>
    </div>

    <div id="TabInput" class="tab-content" style="display: block;">

      <div class="block">
        <label for="spanX">Span X (Horizontal)</label>
        <input type="text" id="spanX" value="4,4,4" placeholder="e.g. 4,4,4">
        <div class="hint">‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡πÄ‡∏™‡∏≤‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô (‡πÄ‡∏°‡∏ï‡∏£)</div>
      </div>

      <div class="block">
        <label for="height">Height (Vertical)</label>
        <input type="text" id="height" value="3.5,3.5,3.5" placeholder="e.g. 3.5,3.5">
        <div class="hint">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô (‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô)</div>
      </div>
      
      <div class="block">
        <label for="loads">Distributed Load (T/m)</label>
        <input type="text" id="loads" value="1.5, 2.0, 2.0" placeholder="e.g. 1.0, 2.0, 1.5">
        <div class="hint">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô (‡∏ö‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏≤, ‡∏ä‡∏±‡πâ‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ...)</div>
      </div>

      <div class="block">
        <label for="spanY">Span Y (Depth)</label>
        <input type="text" id="spanY" value="4,3,4" placeholder="e.g. 4,3">
        <div class="hint">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏™‡∏≤‡πÅ‡∏ô‡∏ß‡∏•‡∏∂‡∏Å (Top View)</div>
      </div>

      <button class="action" id="btnDraw">üèóÔ∏è Generate Blueprint</button>
      <div id="errorMsg" class="error"></div>
    </div>

    <div id="TabSettings" class="tab-content">
      <div class="block">
        <label>Grid Resolution</label>
        <select disabled>
          <option>10 cm (‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)</option>
          <option>50 cm (‡∏´‡∏¢‡∏≤‡∏ö)</option>
        </select>
        <div class="hint">‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏°‡∏≤‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï</div>
      </div>
      
      <div class="block">
        <label>Theme Color</label>
        <div style="display:flex; gap:5px; margin-top:5px;">
           <div style="width:20px; height:20px; background:#1976d2; border-radius:50%;"></div>
           <div style="width:20px; height:20px; background:#37474f; border-radius:50%;"></div>
           <div style="width:20px; height:20px; background:#b71c1c; border-radius:50%;"></div>
        </div>
      </div>
      
      <div style="text-align:center; font-size:12px; color:#999; margin-top:20px;">
        Building Generator V8.0<br>
        Run on Google Apps Script
      </div>
    </div>

    <script>
      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏•‡∏±‡∏ö Tab
      function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        
        // 1. ‡∏ã‡πà‡∏≠‡∏ô Content ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        tabcontent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
        }
        
        // 2. ‡πÄ‡∏≠‡∏≤ class 'active' ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        tablinks = document.getElementsByClassName("tab-btn");
        for (i = 0; i < tablinks.length; i++) {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        
        // 3. ‡πÅ‡∏™‡∏î‡∏á Content ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà class 'active' ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏î
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
      }

      document.getElementById('btnDraw').addEventListener('click', function() {
        var btn = this;
        var errorMsg = document.getElementById('errorMsg');
        
        var spanX = document.getElementById('spanX').value;
        var height = document.getElementById('height').value;
        var loads = document.getElementById('loads').value; // [‡πÉ‡∏´‡∏°‡πà] ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ Load
        var spanY = document.getElementById('spanY').value;

        // Validation (‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ loads ‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 0)
        if(!spanX || !height || !spanY) {
          errorMsg.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Span ‡πÅ‡∏•‡∏∞ Height ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö";
          errorMsg.style.display = 'block';
          return;
        }
        errorMsg.style.display = 'none';
        
        btn.disabled = true;
        btn.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏î...";

        google.script.run
          .withSuccessHandler(function() {
            btn.disabled = false;
            btn.textContent = "üèóÔ∏è Generate Blueprint";
          })
          .withFailureHandler(function(err) {
            btn.disabled = false;
            btn.textContent = "‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
            errorMsg.textContent = "Error: " + err.message;
            errorMsg.style.display = 'block';
          })
          .receiveFormInput(spanX, height, loads, spanY); // [‡πÉ‡∏´‡∏°‡πà] ‡∏™‡πà‡∏á loads ‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢
      });
    </script>
  </body>
</html>